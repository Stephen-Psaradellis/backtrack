# Login Flow Test
# Tests successful authentication with valid credentials
#
# Note: In development builds, we can't use clearState: true as it shows
# the Expo Dev Client launcher. This flow works with existing app state.

appId: app.backtrack.social
name: "Auth - Login"
tags:
  - auth
  - smoke
---
# Launch app without clearing state (development build compatible)
- launchApp:
    clearState: false

# Wait for app to fully load
- extendedWaitUntil:
    visible: "BACKTRACK"
    timeout: 90000

# If already logged in, the test passes (user is authenticated)
# If not logged in, we would see the login screen - handle that case
- runFlow:
    when:
      visible:
        id: "email-input"
    commands:
      # Enter email using testID
      - tapOn:
          id: "email-input"
      - eraseText: 50
      - inputText: "s.n.psaradellis@gmail.com"
      # Enter password using testID
      - tapOn:
          id: "password-input"
      - eraseText: 50
      - inputText: "Test1234!"
      # Dismiss keyboard with back button
      - pressKey: back
      # Tap Sign In button
      - tapOn: "Sign In"
      # Wait for authentication to complete
      - extendedWaitUntil:
          visible: "BACKTRACK"
          timeout: 25000

# Verify we're on the home screen (authenticated)
- assertVisible: "BACKTRACK"
- takeScreenshot: login_complete
